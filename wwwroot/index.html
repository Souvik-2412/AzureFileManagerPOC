<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Azure File Manager</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .upload-section { margin-bottom: 30px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f4f4f4; }
    </style>
</head>
<body>
    <div class="upload-section">
        <h2>Upload File</h2>
        <form id="uploadForm">
            <input type="file" id="fileInput" name="file" required>
            <button type="submit">Upload</button>
        </form>
    </div>

    <h2>Uploaded Files Metadata</h2>
    <table id="filesTable">
        <thead>
            <tr>
                <th>File Name</th>
                <th>Size (KB)</th>
                <th>Type</th>
                <th>Upload Date</th>
            </tr>
        </thead>
        <tbody>
            <!-- Metadata rows will appear here -->
        </tbody>
    </table>

    <script>
        const uploadForm = document.getElementById('uploadForm');
        const filesTableBody = document.querySelector('#filesTable tbody');

        uploadForm.addEventListener('submit', async function(e) {
            e.preventDefault();

            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (!file) return;

            const formData = new FormData();
            formData.append('file', file);

            try {
                const res = await fetch('https://filemanager-poc-app-e8hqhyg0cbbcerhj.centralindia-01.azurewebsites.net/api/upload', {
                    method: 'POST',
                    body: formData
                });

                if (res.ok) {
                    const result = await res.json(); // assuming API returns metadata
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${result.fileName || file.name}</td>
                        <td>${((result.size || file.size) / 1024).toFixed(2)}</td>
                        <td>${result.type || file.type || 'N/A'}</td>
                        <td>${new Date(result.uploadDate || Date.now()).toLocaleString()}</td>
                    `;
                    filesTableBody.appendChild(row);
                    uploadForm.reset();
                    alert('File uploaded successfully!');
                } else {
                    const err = await res.text();
                    alert('Upload failed: ' + err);
                }
            } catch (err) {
                alert('Error: ' + err.message);
            }
        });
    </script>
</body>
</html>
